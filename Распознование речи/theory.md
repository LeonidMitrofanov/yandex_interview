# Распознование речи

## Типы ошибок
![](img/errors_types.png)

## Метрики оценки
1) WER
![](img/WER.png)

Вычисление расстояния левенштейна:
![](img/Levenshtain.png)

## Постановка задачи
Задача выравнивания: Необходимо сопоставить графему с фреймом аудио

1) Равномерно (Не используется): Разбиваем на равные промежутки и смотрим, какая буква на них предсказана
![](img/wave_text.png)

2) Решать как задачу сегментации (Не используют)
![](img/segmentaton.png)
- (-) вручную размечать каждую букву (очень дорого)

3) Seq2Seq ()
![](img/seq2seq.png)
- фрейм - сжатый фрагмент сигнала (не секунды)

## pipline предсказания:
1) MelSpectrograma (Решают проблему размерности: много значений в сек -> меньше значений в сек)
![](img/aboutFrames.png)

2) Свертки + рекурентные сети (уменьшаем еще) -> Линейный слой (уменьшаем еще)
![](img/more_frames.png)

3) Выход линейного слоя
![](img/after_linear.png)

4) Решение проблемы дублирующихся токенов
![](img/dublicate.png)

- проблема: ииддееем___вв__ззоооопаркк -> идем в зопарк
- решение Bank token '|': ииддееем___вв__ззо|ооопаркк -> идем в зоопарк

5) Как выглядит на практике Bank token:
![](img/bankToken.png)

## Проблема: Нам подходят несколько последовательностей
![](img/multi_seq_isgood.png)

### CTC Loss - для решения этой проблемы
![](img/CTC_formula.png)

Разбор формулы:
1) Матрица предсказаний: Y_pred (В формуле с крышкой)
![](img/predict_matrix.png)

2) Считаем вероятность предсказания токена по фреймам:
![](img/predict_prob.png)

3) CTC визуально:
![](img/CTC_graph.png)
- Справа: множество "исходных текстов"
- Слева: множество "последовательностей" из которых можно получить "исходный текст"