## Losses
- Pitch loss — MSE между предсказанным и реальным F0 (частотой основного тона).
- Energy loss — MSE между предсказанной и истинной энергией сигнала
- Stop token loss — бинарная кросс-энтропия: учит модель "знать", когда закончить речь.
- Duration loss — для моделей, которые явно предсказывают длительности фонем (например FastSpeech).

## Метрики
### Subjective (Субъективные): Опрос среди людей
- MOS (Mean Opinion Score): оценка от 1-5. потом все ответы усредняют
    - (-) сложно сравнивать модели
    - (-) большая дисперсия
    - (+) абсолютная: 5-хорошо, 0-плохо

- MUSHRA: Сначала дают референс, как должна звучать модель, потом оценка от 1-5. Усредняют
    - (+-) меньше дисперсия чем с MOS
    - (+) нужна референсная дорожка
- SBS (Side By Side): Даем 2 дорожки, просим оценить, которая лучше
- Robotness: Даем случайные дорожки, просим оценить что из этого человек, а что робот
    - Тесть Тюринга на аудио

### Оjective (Объективные): Их нет, но есть сурогатные метрики
- Сурогатные метрики: (Не показывают насколько хороша модель)
    - WER/CER: Исходная vs Сгенерированная | Word Error Rate/Char Error Rate - в зависимости от выбора меняется растояние Левенштейна
        - Исходная -> ASR -> текст_исх
        - Сгенерированная -> ASR -> текст_сген
        - Растояния Левинштейна(текст_исх, текст_сген) -> S, D, I (Заменить, Удалить, Вставить) кол-во
        - N = len(текст_исх)
        - Ответ: (S+D+I)/N
    - SR (Speaker Recognition): Можно ли по аудио угадать спикера
        - аудио_исх -> SR модель -> фичи_исх
        - аудио_сген -> SR модель -> фичи_сген
        - тут фичи характеризуют спикера
        - Модель SR заранее предобучена
        - Когда говорит 1 спикер растояние между фичами - маленькое, когда разные спикеры - большое
        - Ответ: Растояние(фичи_исх, фичи_сген)
    - SER (Speaker Emotional Recognition): 
        - аудио_исх -> SER модель -> фичи_исх
        - аудио_сген -> SER модель -> фичи_сген
        - тут фичи характеризуют эмоции/стайл
        - Модель SER заранее предобучена
        - Когда эмоции те же растояние между фичами - маленькое, когда разные - большое
        - Ответ: Растояние(фичи_исх, фичи_сген)
    - Neural MOS: Пытаются предсказать MOS как задачу регресии
        - (-) varianse большой


### Errors
1) Hard: сразу понятно, что робот
- wrong stress
- Ударения
2) Soft: 
- не натуральный (naturalness)
- шумность (noisiness)